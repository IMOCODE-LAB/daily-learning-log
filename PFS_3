# ğŸ£ Predict Future Sales ä¿®è¡Œãƒ­ã‚° - Day 3

## âœ… æœ¬æ—¥ã®é€²æ—
- `monthly_shop_item_cnt` ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€ãƒ©ã‚°ç‰¹å¾´é‡ï¼ˆlag_1 / lag_2ï¼‰ã‚’ä½œæˆ
- ãƒ¡ãƒ¢ãƒªå¯¾ç­–ã¨ã—ã¦ `date_block_num` ã‚’4ã‹æœˆåˆ†ã«åˆ¶é™ â†’ **æˆåŠŸğŸ‰**

## ğŸ§  å¾—ã‚‰ã‚ŒãŸå­¦ã³
- `groupby â†’ agg â†’ merge` ã®é›†è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãƒã‚¹ã‚¿ãƒ¼
- `lagç‰¹å¾´é‡` ã®ä½œæˆã«ã¯å¤§é‡ãƒ¡ãƒ¢ãƒªãŒå¿…è¦ï¼ â†’ å°åˆ†ã‘å¯¾å¿œãŒæœ‰åŠ¹
- `date_block_num` ã‚’ã‚ºãƒ©ã—ã¦ãƒ©ã‚°ã‚’ä½œã‚‹ã“ã¨ã§ã€æ™‚ç³»åˆ—æƒ…å ±ã‚’ç‰¹å¾´é‡åŒ–ã§ãã‚‹ï¼

## ğŸ’¡ æ¬¡å›ã‚„ã‚‹ã“ã¨
- `train` / `test` ã«å†åˆ†å‰²ã—ã¦ã€å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™ã‚’é€²ã‚ã‚‹äºˆå®š
- ãƒ¢ãƒ‡ãƒ«ä½œæˆã«å‘ã‘ã¦ã€å¿…è¦ãªå‰å‡¦ç†ã‚’æ•´ç†

## ğŸ§° ä½¿ç”¨ã—ãŸé–¢æ•°ï¼ˆãƒ©ã‚°ç‰¹å¾´é‡ç”Ÿæˆï¼‰
```python
def add_lag_feature(df, lags, col):
    for lag in lags:
        lag_col_name = f"{col}_lag_{lag}"
        shifted = df[['date_block_num', 'shop_id', 'item_id', col]].copy()
        shifted['date_block_num'] += lag
        shifted.rename(columns={col: lag_col_name}, inplace=True)
        df = df.merge(shifted, on=['date_block_num', 'shop_id', 'item_id'], how='left')
    return df
